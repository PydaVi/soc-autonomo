function checkSubmit(form)
{
	if (document.configure.refresh_rate.value.search(/^\d{1,10}$/) == -1)
	{
		alert("Invalid web page refresh rate");
		document.configure.refresh_rate.select();
		return false;
	}
	if (parseInt(document.configure.refresh_rate.value) > 1800)
	{
		alert("Web page refresh rate is out of range.");
		document.configure.refresh_rate.select();
		return false;
	}
	if (parseInt(document.configure.refresh_rate.value) < 0)
	{
		alert("Web page refresh rate is out of range.");
		document.configure.refresh_rate.select();
		return false;
	}
	if (document.configure.login_timeout.value.search(/^\d{1,10}$/) == -1){
		alert("Invalid login timeout");
		document.configure.login_timeout.select();
		return false;
	}
	if (parseInt(document.configure.login_timeout.value) > 1440){
		alert("Login timeout is out of range.");
		document.configure.login_timeout.select();
		return false;
	}
	if (parseInt(document.configure.login_timeout.value) < 0){
		alert("Login timeout is out of range.");
		document.configure.login_timeout.select();
		return false;
	}
	if (	document.configure.authmethod[document.configure.authmethod.selectedIndex].value != "LOCAL" &&
		document.configure.authmethod[document.configure.authmethod.selectedIndex].value != "PAM"){
		if(document.configure.p_radius_auth.value != "")
			if(checkIP(document.configure.p_radius_auth)==false) return false;
		if(document.configure.s_radius_auth.value != "")
			if(checkIP(document.configure.s_radius_auth)==false) return false;
	}
	if(document.configure.authmethod[document.configure.authmethod.selectedIndex].value == "RS"||
		document.configure.authmethod[document.configure.authmethod.selectedIndex].value == "RDL")
	{
		if(isNaN(document.configure.radius_timeout.value) || (document.configure.radius_timeout.value == ""))
		{
			alert("Please provide the radius timeout (0-300 sec.)");
			document.configure.radius_timeout.select();
			return false;
		}
		if(parseInt(document.configure.radius_timeout.value) > 300 || parseInt(document.configure.radius_timeout.value) < 0)
		{
			alert("Please provide an integer value between 0 and 300");
			document.configure.radius_timeout.select();
			return false;
		}
		if(isNaN(document.configure.radius_retries.value) || (document.configure.radius_retries.value == ""))
		{
			alert("Please provide the radius retries (1-50 times)");
			document.configure.radius_retries.select();
			return false;
		}
		if(parseInt(document.configure.radius_retries.value) > 50 || parseInt(document.configure.radius_retries.value) < 1)
		{
			alert("Please provide an integer value between 1 and 50");
			document.configure.radius_retries.select();
			return false;
		}
	}
	if (document.configure.web_max_count.value.search(/^\d{1,10}$/) == -1){
		alert("Invalid ports count");
		document.configure.web_max_count.select();
		return false;
	}
	if (parseInt(document.configure.web_max_count.value) > 90){
		alert("Ports count is out of range.");
		document.configure.web_max_count.select();
		return false;
	}
	if (parseInt(document.configure.web_max_count.value) < 16){
		alert("Ports count is out of range.");
		document.configure.web_max_count.select();
		return false;
	}
	return true;
}

function checkIP(comp)
{
	if(comp.value.search(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/) != -1)
	{
		var myArray = comp.value.split(/\./);
		if(myArray[0] > 255 || myArray[1] > 255 || myArray[2] > 255 || myArray[3] > 255)
		{
			alert("Invalid IP address");
			comp.select();
			return false;
		}
		if(myArray[0] == 255 && myArray[1] == 255 && myArray[2] == 255 && myArray[3] == 255)
		{
			alert("Invalid IP address");
			comp.select();
			return false;
		}
	}
	else
	{
		alert("Invalid IP address");
		comp.select();
		return false;
	}
	return true;
}

function checkValue()
{
	document.configure.action = "/webserverconfig.asp";
	document.configure.submit();
}
