function WritePort(np,title,npp,nc,nm,nu,nusers,user,comment,bgcolor,sIP,nPort,na)
{
	var pV="";
	var pN=np;
	if(np>100){
		pV="R";
		pN=np-100;
	}
	document.write("<tr>");
	document.write("<td></td>");
	if(npp==0){
		document.write("<td></td>");
	}else if(npp==1){
		document.write("<td align=center><a href=\"portpowermanage.asp?port="+np+"\"><img src=/images/G.gif alt=\"On\" width=12 height=11></a></td>");
	}else if(npp==2){
		document.write("<td align=center><a href=\"portpowermanage.asp?port="+np+"\"><img src=/images/R.gif alt=\"Off\" width=12 height=11></a></td>");
	}else if(npp==5){
		document.write("<td align=center><a href=\"phantom.asp?mode=4&port="+np+"\"><img src=/images/G.gif alt=\"On\" width=12 height=11></a></td>");
	}else if(npp==6){
		document.write("<td align=center><a href=\"phantom.asp?mode=4&port="+np+"\"><img src=/images/R.gif alt=\"Off\" width=12 height=11></a></td>");
	}else{
		document.write("<td align=center><img src=/images/Y.gif alt=\"Y\" width=12 height=11></td>");
	}
	if(nc==0){
		document.write("<td></td>");
	}else if(nc==1){
		document.write("<td align=center><a href=\"telnet://"+sIP+":"+nPort+"\"><img src=/images/connect.gif alt=\"connect port "+pV+""+pN+" on telnet\" width=12 height=11></a></td>");
	}else if(nc==5){
		document.write("<td align=center><a href=\"ssh2://"+sIP+":"+nPort+"\"><img src=/images/connect.gif alt=\"connect port "+pV+""+pN+" on SSH\" width=12 height=11></a></td>");
	}else if(nc==2){
		document.write("<td align=center><a href=\"#\" onClick=\"openTelnet("+np+")\"><img src=/images/connect.gif alt=\"connect port "+pV+""+pN+" on web applet\" width=12 height=11></a></td>");
	}else if(nc==3){
		document.write("<td align=center><a href=\"#\" onClick=\"openSSH("+np+")\"><img src=/images/connect.gif alt=\"connect port "+pV+""+pN+" on web applet\" width=12 height=11></a></td>");
	}else if(nc==6){//from master
		document.write("<td align=center><a href=\"#\" onClick=\"alert(\'Please, use the serial port connection page of the master unit.\')\"><img src=/images/connect.gif alt=\"Connect through master unit\" width=12 height=11></a></td>");
	}else{
		document.write("<td align=center><a href=\"#\" onClick=\"alert(\'Fail to connect port "+pV+""+pN+", parameter missing.\')\"><img src=/images/connect.gif alt=\"Not to connect port "+pV+""+pN+", parameter missing\" width=12 height=11></a></td>");
	}
	if(nm==1){
		document.write("<td align=center><a href=\"SAC.asp?port="+np+"\"><img src=/images/M.gif alt=\"MS SAC\" width=12 height=11></a></td>");
		document.write("<td align=center><a href=\"SAC.asp?port="+np+"\"> "+pV+""+pN+"</a></td>");
		if (na==1)
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open MS SAC console on port "+pV+""+pN+"\"><img src=/images/alert.gif alt=\"[ALERT]\" width=12 height=11><a href=\"SAC.asp?port="+np+"\"> "+title+"</a></td>");
		else
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open MS SAC console on port "+pV+""+pN+"\"><a href=\"SAC.asp?port="+np+"\">"+title+"</a></td>");
	}else if(nm==4){
		document.write("<td align=center><a href=\"SAC.asp?port="+np+"\"><img src=/images/M.gif alt=\"MS SAC\" width=12 height=11></a></td>");
		document.write("<td align=center><a href=\"SAC.asp?port="+np+"\"> "+pV+""+pN+"</a></td>");
		if (na==1)
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open MS SAC console on port "+pV+""+pN+"\"><img src=/images/alert.gif alt=\"[ALERT]\" width=12 height=11><a href=\"SAC.asp?port="+np+"\"> "+title+"</a></td>");
		else
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open MS SAC console on port "+pV+""+pN+"\"><a href=\"SAC.asp?port="+np+"\">"+title+"</a></td>");
	}else if(nm==3){ // power controller
		document.write("<td align=center><a href=\"powerunitmanage.asp?port="+np+"\"><img src=/images/M.gif alt=\"Power controller\" width=12 height=11></a></td>");
		document.write("<td align=center><a href=\"powerunitmanage.asp?port="+np+"\"> "+pV+""+pN+"</a></td>");
		if (na==1)
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open power controller management on port "+pV+""+pN+"\"><img src=/images/alert.gif alt=\"[ALERT]\" width=12 height=11><a href=\"powerunitmanage.asp?port="+np+"\"> "+title+"</a></td>");
		else
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open power controller management on port "+pV+""+pN+"\"><a href=\"powerunitmanage.asp?port="+np+"\">"+title+"</a></td>");
	}else if(nm>=10){ // 20040729 phantom
		var nSAC = nm % 10;
		if(nSAC==1||nSAC==4){
			document.write("<td align=center><a href=\"#\" onClick=\"openManageSelect("+np+","+nm+")\"><img src=/images/M.gif alt=\"Rackable Systems Mgmt Card or MS SAC\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"#\" onClick=\"openManageSelect("+np+","+nm+")\"> "+pV+""+pN+"</a></td>");
			if (na==1)
				document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open Rackable Systems Mgmt Card or MS SAC console on port "+pV+""+pN+"\"><img src=/images/alert.gif alt=\"[ALERT]\" width=12 height=11><a href=\"#\" onClick=\"openManageSelect("+np+","+nm+")\"> "+title+"</a></td>");
			else
				document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open Rackable Systems Mgmt Card or MS SAC console on port "+pV+""+pN+"\"><a href=\"#\" onClick=\"openManageSelect("+np+","+nm+")\">"+title+"</a></td>");
		}else{
			document.write("<td align=center><a href=\"phantom.asp?port="+np+"\"><img src=/images/M.gif alt=\"Rackable Systems Mgmt Card\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"phantom.asp?port="+np+"\"> "+pV+""+pN+"</a></td>");
			if (na==1)
				document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open Rackable Systems Mgmt Card on port "+pV+""+pN+"\"><img src=/images/alert.gif alt=\"[ALERT]\" width=12 height=11><a href=\"phantom.asp?port="+np+"\"> "+title+"</a></td>");
			else
				document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open Rackable Systems Mgmt Card on port "+pV+""+pN+"\"><a href=\"phantom.asp?port="+np+"\">"+title+"</a></td>");
		}
	}else{
		document.write("<td></td>");
		document.write("<td align=center> "+pV+""+pN+"</td>");
		if (na==1)
			document.write("<td><img src=/images/alert.gif alt=\"[ALERT]\" width=12 height=11> "+title+"</td>");
		else
			document.write("<td>"+title+"</td>");
	}
	if(nu==0){
		document.write("<td align=center>"+nusers+"</td>");
		document.write("<td>"+user+"</td>");
	}else{
		document.write("<td align=center><a href=\"#\" onClick=\"openPortUsers("+np+")\">"+nusers+"</a></td>");
		document.write("<td><a href=\"#\" onClick=\"openPortUsers("+np+")\">"+user+"</a></td>");
	}
	document.write("<td>"+comment+"</td>");
	document.write("</tr>");
}

function WritePortSlave(unit,np,title,npp,nc,nm,bgcolor,sIP,nPort,url)
{
	var unitnum = unit.charCodeAt(0) - "A".charCodeAt(0) + 1;
	document.write("<tr>");
	document.write("<td></td>");
	if(npp==0){
		document.write("<td></td>");
	}else if(npp==8){ // phantom
		if(url==""){
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\"><img src=/images/Y.gif alt=\"Not linked to slave unit " + unit + "\" width=12 height=11></a></td>");
		}else{
			document.write("<td align=center><a href=\"#\" onClick=\"openPhantom(\'"+url+"\'," + np + ",4)\"><img src=/images/Y.gif alt=\"Unknown\" width=12 height=11></a></td>");
		}
	}else{
		if(url==""){
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\"><img src=/images/Y.gif alt=\"Not linked to slave unit " + unit + "\" width=12 height=11></a></td>");
		}else{
			document.write("<td align=center><a href=\"#\" onClick=\"openPortPowerManage(\'"+url+"\'," + np + ")\"><img src=/images/Y.gif alt=\"Unknown\" width=12 height=11></a></td>");
		}
	}
	if(nc==0){
		document.write("<td></td>");
	}else if(nc==1){
		document.write("<td align=center><a href=\"telnet://"+sIP+":"+nPort+"\"><img src=/images/connect.gif alt=\"connect port "+unit+""+np+" on telnet\" width=12 height=11></a></td>");
	}else if(nc==5){
		document.write("<td align=center><a href=\"ssh2://"+sIP+":"+nPort+"\"><img src=/images/connect.gif alt=\"connect port "+unit+""+np+" on SSH\" width=12 height=11></a></td>");
	}else if(nc==2){
		document.write("<td align=center><a href=\"#\" onClick=\"openTelnetSlave("+unitnum+","+np+")\"><img src=/images/connect.gif alt=\"connect port "+unit+""+np+" on web applet\" width=12 height=11></a></td>");
	}else if(nc==3){
		document.write("<td align=center><a href=\"#\" onClick=\"openSSHSlave("+unitnum+","+np+")\"><img src=/images/connect.gif alt=\"connect port "+unit+""+np+" on web applet\" width=12 height=11></a></td>");
	}else{
		document.write("<td align=center><a href=\"#\" onClick=\"alert(\'Fail to connect port "+unit+""+np+", parameter missing.\')\"><img src=/images/connect.gif alt=\"Not to connect port "+unit+""+np+", parameter missing\" width=12 height=11></a></td>");
	}
	if(nm==1||nm==4){
		if(url==""){
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\"><img src=/images/M.gif alt=\"Not linked to slave unit " + unit + "\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\">"+unit+""+np+"</a></td>");
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"Not linked to slave unit " + unit + "\"><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\">"+title+"</a></td>");
		}else{
			document.write("<td align=center><a href=\"#\" onClick=\"openSAC(\'"+url+"\',"+np+ ")\"><img src=/images/M.gif alt=\"MS SAC\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"#\" onClick=\"openSAC(\'"+url+"\',"+np+ ")\">"+unit+""+np+"</a></td>");
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open MS SAC console on port "+unit+""+np+"\"><a href=\"#\" onClick=\"openSAC(\'"+url+"\',"+np+ ")\">"+title+"</a></td>");
		}
	//}else if(nm==4){
	}else if(nm==3){ // power controller
		if(url==""){
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\"><img src=/images/M.gif alt=\"Not linked to slave unit " + unit + "\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\">"+unit+""+np+"</a></td>");
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"Not linked to slave unit " + unit + "\"><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\">"+title+"</a></td>");
		}else{
			document.write("<td align=center><a href=\"#\" onClick=\"openPowerUnitManage(\'"+url+"\',"+np+ ")\"><img src=/images/M.gif alt=\"Power controller\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"#\" onClick=\"openPowerUnitManage(\'"+url+"\',"+np+ ")\">"+unit+""+np+"</a></td>");
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open power controller management on port "+unit+""+np+"\"><a href=\"#\" onClick=\"openPowerUnitManage(\'"+url+"\',"+np+ ")\">"+title+"</a></td>");
		}
	}else if(nm>=10){ // 20040729 phantom
		if(url==""){
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\"><img src=/images/M.gif alt=\"Not linked to slave unit " + unit + "\" width=12 height=11></a></td>");
			document.write("<td align=center><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\">"+unit+""+np+"</a></td>");
			document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"Not linked to slave unit " + unit + "\"><a href=\"#\" onClick=\"notLink(\'"+unit+"\')\">"+title+"</a></td>");
		}else{
			var nSAC = nm % 10;
			if(nSAC==1||nSAC==4){
				document.write("<td align=center><a href=\"#\" onClick=\"openManageSelectSlave("+unitnum+","+np+","+nm+")\"><img src=/images/M.gif alt=\"Rackable Systems Mgmt Card or MS SAC\" width=12 height=11></a></td>");
				document.write("<td align=center><a href=\"#\" onClick=\"openManageSelectSlave("+unitnum+","+np+","+nm+")\"> "+unit+""+np+"</a></td>");
				document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open Rackable Systems Mgmt Card or MS SAC console on port "+unit+""+np+"\"><a href=\"#\" onClick=\"openManageSelectSlave("+unitnum+","+np+","+nm+")\">"+title+"</a></td>");
			}else{
				document.write("<td align=center><a href=\"#\" onClick=\"openPhantom(\'"+url+"\',"+np+ ",1)\"><img src=/images/M.gif alt=\"Rackable Systems Mgmt Card\" width=12 height=11></a></td>");
				document.write("<td align=center><a href=\"#\" onClick=\"openPhantom(\'"+url+"\',"+np+ ",1)\">"+unit+""+np+"</a></td>");
				document.write("<td onMouseOver=\'this.style.cursor=\"hand\"; this.style.backgroundColor=\""+bgcolor+"\"; this.style.color=\"#000000\";\'onMouseOut=\'this.style.cursor=\"auto\"; this.style.backgroundColor=\"#FFFFFF\"; this.style.color=\"#3d3d3d\";\' title=\"open Rackable Systems Mgmt Card on port "+unit+""+np+"\"><a href=\"#\" onClick=\"openPhantom(\'"+url+"\',"+np+ ",1)\">"+title+"</a></td>");
			}
		}
	}else{
		document.write("<td></td>");
		document.write("<td align=center> "+unit+""+np+"</td>");
		document.write("<td>"+title+"</td>");
	}
	document.write("<td colspan=2>Unit "+unit+"</td>");
	if(nm==3){ // power controller
		document.write("<td>< Power controller ></td>");
	}else{
		document.write("<td>----------</td>");
	}
	document.write("</tr>");
}
function notLink(unit)
{
	alert("Web interface of Unit "+unit+" is disabled.");
}
function openPortPowerManage(url,np)
{
	//var urlFull=url+"authen.asp?page=/portpowermanage.asp?port="+np;
	var urlFull=url+"portpowermanage.asp?port="+np;
	var newWin=window.open(urlFull,"","width=900,height=675,location,menubar,resizable,scrollbars");
	newWin.moveTo(screen.width/2-450,screen.height/2-338);
}
function openSAC(url,np)
{
	//var urlFull=url+"authen.asp?page=/SAC.asp?port="+np;
	var urlFull=url+"SAC.asp?port="+np;
	var newWin=window.open(urlFull,"","width=900,height=675,location,menubar,resizable,scrollbars");
	newWin.moveTo(screen.width/2-450,screen.height/2-338);
}
function openPowerUnitManage(url,np)
{
	//var urlFull=url+"authen.asp?page=/powerunitmanage.asp?port="+np;
	var urlFull=url+"powerunitmanage.asp?port="+np;
	var newWin=window.open(urlFull,"","width=900,height=675,location,menubar,resizable,scrollbars");
	newWin.moveTo(screen.width/2-450,screen.height/2-338);
}
function openPhantom(url,np,mode)
{
	//var urlFull=url+"authen.asp?page=/phantom.asp?port="+np;
	var urlFull=url+"phantom.asp?mode="+mode+"&port="+np;
	var newWin=window.open(urlFull,"","width=900,height=675,location,menubar,resizable,scrollbars");
	newWin.moveTo(screen.width/2-450,screen.height/2-338);
}

function openTelnet(port)
{
/*	var newWindow;
	url = "telnet.asp?port="+port;
	newWindow = window.open(url, "Telnet", "width=550, height=430");
*/
	var url = "telnet.asp?port=" + port;
	var target = "Telnet" + port; 
	var newWin;
	//if(isNN7()==true)
	//	url +="&size=[80,20]";
	if(check_browser())
		newWin=window.open(url, "", "width=640,height=622");
	else{
		newWin=window.open(url, target, "width=640,height=622");
		//newWin.resizeTo(640,572); //old height
	}
	//newWin.moveTo(screen.width/2-320,screen.height/2-286);
/*
window.open(url, "", "width=640, height=572");
window.open(url, target, "width=640, height=572");
window.open(url, target, "width=550, height=430");
*/
}

function openSSH(port)
{
/*	var newWindow;
	url = "ssh.asp?port="+port;
	newWindow = window.open(url, "SSH", "width=550, height=430");
*/
	var url = "ssh.asp?port=" + port;
	var target = "SSH" + port; 
	var newWin;
	//if(isNN7()==true)
	//	url +="&size=[80,20]";
	if(check_browser())
		newWin=window.open(url, "", "width=640,height=622");
	else{
		newWin=window.open(url, target, "width=640,height=622");
		//newWin.resizeTo(640,572);
	}
	//newWin.moveTo(screen.width/2-320,screen.height/2-286);
/*
window.open(url, "", "width=640, height=572");
window.open(url, target, "width=640, height=572");
window.open(url, target, "width=550, height=430");
*/
}
function openTelnetSlave(unitnum, port)
{
	var url = "clustertelnet.asp?unit=" + unitnum + "&port=" + port;
	var target = "Telnet" + port;
	var newWin;
	if(check_browser())
		newWin=window.open(url, "", "width=640, height=622");
	else{
		newWin=window.open(url, target, "width=640, height=622");
	}
}

function openSSHSlave(unitnum, port)
{
	var url = "clusterssh.asp?unit=" + unitnum + "&port=" + port;
	var target = "SSH" + port;
	var newWin;
	if(check_browser())
		newWin=window.open(url, "", "width=640, height=622");
	else{
		newWin=window.open(url, target, "width=640, height=622");
	}
}
function openPortUsers(port)
{
	var url="portusers.asp?port="+port;
	var target="PortUsers"+port;
	var newWin;
	if(check_browser())
		newWin=window.open(url, "", "width=420,height=300,scrollbars");
	else
		newWin=window.open(url, target, "width=420,height=300,scrollbars");
	newWin.moveTo(screen.width/2-210,screen.height/2-150);
}

function openManageSelect(port,manage)
{
	var url="manageselect.asp?port="+port+"&manage="+manage;
	var target="ManageSelect"+port;
	if(check_browser())
		newWin=window.open(url, "", "width=420,height=200,scrollbars");
	else
		newWin=window.open(url, target, "width=420,height=200,scrollbars");
	newWin.moveTo(screen.width/2-210,screen.height/2-100);
}
function openManageSelectSlave(unit,port,manage)
{
	var url="manageselect.asp?unit="+unit+"&port="+port+"&manage="+manage;
	var target="ManageSelect"+unit+"_"+port;
	if(check_browser())
		newWin=window.open(url, "", "width=420,height=200,location,menubar,resizable,scrollbars");
	else
		newWin=window.open(url, target, "width=420,height=200,location,menubar,resizable,scrollbars");
	newWin.moveTo(screen.width/2-210,screen.height/2-100);
}
function moveToPage()
{
	var form=document.configure;
	var formMoveTo=document.moveto;
	if(formMoveTo.page.selectedIndex==0) return;
	form.page.value=formMoveTo.page.options[formMoveTo.page.selectedIndex].value;
	form.submit();
}
function initrefresh()
{
	var time = parseInt(document.configure.refresh_rate.value);
	if(time==0) return;	
	setTimeout("refresh_page()", time*1000);
}

function refresh_page()
{
	var time = parseInt(document.configure.refresh_rate.value);
	if(check_browser()){
		var elempara = document.getElementById("serial_menu_0");
		if(elempara.style.display != "none"){
			document.configure.submit();
		}else{
			setTimeout("refresh_page()", time*1000);
		}
	}else{
		document.configure.submit();
	}
}

function isNN7()
{
	//alert(navigator.appName + ":" + navigator.appVersion + ":" + parseInt(navigator.appVersion));
	var Version=parseInt(navigator.appVersion);
	if(navigator.appName.indexOf("Netscape")==-1)
		return false;
	if(Version==5)
		return true;
	return false;
}

function check_browser()
{
	var isNNav, isMSIE, isKonq
	var Version = parseInt(navigator.appVersion);
	if(Version >= 4){
		isNNav = (navigator.appName == "Netscape")
		isMSIE = (navigator.appName.indexOf("Microsoft") != -1)
		isKonq = (navigator.appName.indexOf("Konqueror") != -1)
	}
	if(isMSIE){
		if(navigator.appVersion.indexOf("Macintosh")!=-1){
		}else if(navigator.appVersion.indexOf("Windows")!=-1){
		}else{
		}
	}else if(isNNav){
		if(Version>= 5){
			if(navigator.appVersion.indexOf("Macintosh")!=-1){
			}else if(navigator.appVersion.indexOf("Windows")!=-1){
			}else if(navigator.appVersion.indexOf("X11")!=-1){
			}else{
			}
		}else{
			return false;
//			alert("User \"" + user.value + "\" added successfully. To see the user list correctly, please select [Save to flash]");
		}
	}else if(isKonq){
	}
	return true;
}
