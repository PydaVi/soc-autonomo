function checkSubmit(form)
{
	var start;
	var ipaddr;
	var ipcheckres;
	if(form.enableLinkDownTrap)
		start=8;
	else
		start=7;
	for (i=start;i<=form.elements.length-4;i+=3)
	{
		ipaddr=form.elements[i];
		if(i<start+3*4){
			ipcheckres=checkDefault(ipaddr);
		}else{
			ipcheckres=false;
		}
		if(ipcheckres==false){
			ipcheckres=checkIP(ipaddr);
			if(ipcheckres==false) return false;
		}
	}
	var ret0=-1;
	for (i=start+1;i<=form.elements.length-3;i+=3)
	{
		rTok = / /g;  
		ret0 = form.elements[i].value.search(rTok);
		if(ret0>=0)
		{
			alert("You should not use blank characters in community string");
			form.elements[i].select();
			return false;
		}
	}
	for(i=0; i<form.elements.length; i++)
	{
		if(form.elements[i].value == "")
		{
			alert("Please provide the value.");
			form.elements[i].focus();
			return false;
		}
		var rTok, ret=-1;
		rTok = /\"/g;
		ret = form.elements[i].value.search(rTok);
		if(ret>=0) 
		{
			alert("You should not use \'\"\' as input");
			form.elements[i].select();
			return false;
		}
	}
/*	for(i=0; i<form.elements.length; i++)
	{
		form.elements[i].disabled=false;
	}*/
	return true;
}
 
function checkDefault(comp)
{
	if(comp.value.toLowerCase()=="default"){
		comp.value="default";
		return true;
	}
	return false;
}

function checkIP(comp)
{
	if(comp.value.search(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/) != -1)
	{
		var myArray = comp.value.split(/\./);
		if(myArray[0] > 255 || myArray[1] > 255 || myArray[2] > 255 || myArray[3] > 255)
		{
			alert("Invalid IP address");
			comp.select();
			return false;
		}
		if(myArray[0] == 255 && myArray[1] == 255 && myArray[2] == 255 && myArray[3] == 255)
		{
			alert("Invalid IP address");
			comp.select();
			return false;
		}
	}
	else
	{
		alert("Invalid IP address");
		comp.select();
		return false;
	}
	return true;
}
