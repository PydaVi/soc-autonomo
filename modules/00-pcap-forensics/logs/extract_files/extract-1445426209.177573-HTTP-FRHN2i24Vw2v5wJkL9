<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<script type="text/javascript">  
<!--
	var i;
	function OptionSelected(){
		document.getElementById("802.1q_option").selected=true;    	
    }
	function ConVlanModeChange(form) {	
		
		if(form.con_vlanmode_sel.options[form.con_vlanmode_sel.selectedIndex].value==1){			
			parent.mid.location.href="../portbase_vlan_setting.asp";			
		}else if(form.con_vlanmode_sel.options[form.con_vlanmode_sel.selectedIndex].value==2){
			parent.mid.location.href="../unaware_vlan_setting.asp";
		}
	}
	
	function ActiveVLAN(){
		if( document.vlan_setting_form.vlan_management_id.value != vlan_frame.document.getElementById("vlan_show_form").org_manage_vid.value ){
			vlan_frame.document.getElementById("vlan_show_form").vlan_management_id.value=document.vlan_setting_form.vlan_management_id.value;
			vlan_frame.document.getElementById("vlan_show_form").action="/goform/VLANManagemwntIDCheck";
			vlan_frame.document.getElementById("vlan_show_form").submit();			
		}else{
			if (document.vlan_setting_form.gvrpEnable.checked)
				vlan_frame.document.getElementById("vlan_show_form").gvrpEnable.value="on";
			else
				vlan_frame.document.getElementById("vlan_show_form").gvrpEnable.value="";
			vlan_frame.document.getElementById("vlan_show_form").action="/goform/TagBaseVlanActivate";
			vlan_frame.document.getElementById("vlan_show_form").submit();			
		}
	}
		
	var port1;
	function PortTypeSelect(port1){
		var port;
		i=eval(port1);
		if(vlan_frame.document.getElementsByTagName("select")[i].options[vlan_frame.document.getElementsByTagName("select")[i].selectedIndex].value==0){
			vlan_frame.document.getElementsByTagName("input")[i*3+1].disabled=true;
			vlan_frame.document.getElementsByTagName("input")[i*3+2].disabled=true;
			vlan_frame.document.getElementsByTagName("input")[i*3+1].style.backgroundColor="#F5F5F5";
			vlan_frame.document.getElementsByTagName("input")[i*3+2].style.backgroundColor="#F5F5F5";
		}else if(vlan_frame.document.getElementsByTagName("select")[i].options[vlan_frame.document.getElementsByTagName("select")[i].selectedIndex].value==1){
			vlan_frame.document.getElementsByTagName("input")[i*3+1].disabled=false;
			vlan_frame.document.getElementsByTagName("input")[i*3+2].disabled=false;
			vlan_frame.document.getElementsByTagName("input")[i*3+1].style.backgroundColor="#FFFFFF";
			vlan_frame.document.getElementsByTagName("input")[i*3+2].style.backgroundColor="#FFFFFF";				
		}
	}
	function touchLasttime()
	{
							theName = "lasttime";
					expires = null;
					now=new Date( );
					document.cookie =theName + "=" + now.getTime() + "; path=/" + ((expires == null) ? " " : "; expires = " +expires.toGMTString());

	}
	function CheckCookie()
	{
		
	}	
	function AccountDiff(){	
		var i;
		CheckCookie();
		OptionSelected();
		
		for(i=0;i<vlan_frame.document.getElementsByTagName("select").length;i++){
			PortTypeSelect(i);
		}
		
		theData = "";
		theName = "AccountName508=";
		theCookie = document.cookie+";";
		start = theCookie.indexOf(theName);
		if(start != -1){
			end=theCookie.indexOf(";",start);
			theData = unescape(theCookie.substring(start+theName.length,end));
		}
		var i;
		if(theData=="user"){
			for(i=0;i<document.getElementsByTagName("input").length;i++){
				document.getElementsByTagName("input")[i].disabled=true;
				document.getElementsByTagName("input")[i].style.backgroundColor="#F5F5F5";
			}
			for(i=0;i<document.getElementsByTagName("select").length;i++){
				document.getElementsByTagName("select")[i].disabled=true;
				document.getElementsByTagName("select")[i].style.backgroundColor="#F5F5F5";
			}					
		}						
	}
	
	function stopSubmit()
	{
		return false;
	}	
	
//-->
</script>
</head>
 
<body bgcolor="#CCE6E6" text="#000000" topmargin="10" leftmargin="12" onLoad="AccountDiff()">
<form method="post" name="vlan_setting_form" onClick="touchLasttime()" onkeypress="touchLasttime()" onSubmit="return stopSubmit()">
<div align="left">        
	<font size="5" face="Arial, Helvetica, sans-serif, Marlett" color="#007C60"><b>	
    802.1Q VLAN Settings</b></font>
</div>  
<div align="left">
    
<table width="100%" border="0" align="left">

    <tr>
		<td width="3%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
			</font></div></td>	
		<td width="20%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
			VLAN Mode</font></div></td>    
<td width="77%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett"> 
			<select name="con_vlanmode_sel" size="1" onchange="ConVlanModeChange(document.vlan_setting_form)"><option value="0" id="802.1q_option">802.1Q VLAN</option>
<option value="1" id="portbase_option">Port-based VLAN</option>
</select></font></div></td>	</tr>



<tr>
  	<td width="3%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
		</font></div></td>	
  	<td width="20%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
		Management VLAN ID</font></div></td>    
    <td width="77%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett"> 
    	<input type="text" name="vlan_management_id" size="4" maxlength="4" value="1" >
</font></div></td>
</tr>
	<tr>
		<td width="3%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
			</font></div></td>
		<td width="20%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
			Enable GVRP</font></div></td>
		<td><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
			<input type="checkbox" name="gvrpEnable" checked></font></div></td>
</tr>

<tr>
	<td width="3%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
		</font></div></td>
	<td width="97%" colspan="2"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
		<table width="690" border="0" align="left">
  			<tr bgcolor="#007C60">
  				<td width="10%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett" color="#FFFFFF">
					Port</font></div></td>
    			<td width="13%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett" color="#FFFFFF">
					Type</font></div></td>    
    			<td width="11%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett" color="#FFFFFF"> 
    				PVID</font></div></td>
    			<td width="33%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett" color="#FFFFFF"> 
    				Fixed VLAN (Tagged)</font></div></td>
    			<td width="33%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett" color="#FFFFFF"> 
    				Forbidden VLAN</font></div></td>
  			</tr>
		</table>
	</td>	
</tr>

<tr>
	<td width="3%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
		</font></div></td>
    <td width="97%" colspan="2"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">    	
		<iframe name="vlan_frame" src="tagbase_vlan_setting_show.asp" width="707" height="310" marginHeight="0" marginWidth="0" frameBorder="0">
		</iframe></font></div></td>	
</tr>

<tr>
	<td width="3%"><div align="left"><font size="2" face="Arial, Helvetica, sans-serif, Marlett">
		</font></div></td>
	<td width="97%" colspan="2"><div align="center"><font size="2" face="Arial, Helvetica, sans-serif, Marlett"> 
		<input type="image" src="activate_button.gif" onClick="ActiveVLAN()" onMouseover="document.body.style.cursor='hand'" onMouseout="document.body.style.cursor='default'"></font></div></td>
</tr>

</table>
</div>
</form>
</body> 
</html> 
