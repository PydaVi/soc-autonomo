<HTML><HEAD>
<script type="text/javascript">
var xmlhttp;
var UpdateState = 0;
var int2;
var NumUpdates = 0;
var ButtonMode = 1;
var ResetMode = 0;
function GetStatus()
{
if (UpdateState == 0)
{
UpdateState = 1;
xmlhttp=GetXmlHttpObject();
if (xmlhttp==null){
alert ("Your browser does not support XMLHTTP!");
return;}
var url ="getstatus.html";
url=url+"&sid="+Math.random();
if (ResetMode){url=url+"?r=1";ResetMode = 0;NumUpdates = 0;}
xmlhttp.onreadystatechange=stateChanged;
xmlhttp.open("GET",url,true);
xmlhttp.send(null);}}
function GetXmlHttpObject(){
if (window.XMLHttpRequest){
return new XMLHttpRequest();}
if (window.ActiveXObject){
return new ActiveXObject("Microsoft.XMLHTTP");}
return null;}
function replaceButtonText(buttonId, text){
if (document.getElementById){
var button=document.getElementById(buttonId);
if (button){
if (button.childNodes[0]){
button.childNodes[0].nodeValue=text;}
else if (button.value){
button.value=text;}
else{button.innerHTML=text;}}}}
function DoStartStopButtonClick(){
if (!ButtonMode){
replaceButtonText("ssB", "Stop Updates");
ButtonMode = 1;
int2=self.setInterval("GetStatus()",50);
}else{
replaceButtonText("ssB", "Start Updates");
ButtonMode = 0;
int2=window.clearInterval(int2)}}
function DoResetCounters(){ResetMode = 1;}
function stateChanged(){
if (xmlhttp.readyState==4){
var xmlResp=xmlhttp.responseXML;
if (xmlResp==null) {UpdateState = 0; return null;}
var xmlDoc=xmlResp.documentElement;
if (xmlDoc != null){
var tbl2 = document.getElementById("TableStatus");
NumUpdates++;
for (i=1; i<17; i++){
var lbl = "T" + i;
var v1 = xmlDoc.getElementsByTagName(lbl)[0].getElementsByTagName("D1")[0].childNodes[0].nodeValue;
var v2 = xmlDoc.getElementsByTagName(lbl)[0].getElementsByTagName("D2")[0].childNodes[0].nodeValue;
var v3 = xmlDoc.getElementsByTagName(lbl)[0].getElementsByTagName("D3")[0].childNodes[0].nodeValue;
var v4 = xmlDoc.getElementsByTagName(lbl)[0].getElementsByTagName("D4")[0].childNodes[0].nodeValue;
var v5 = xmlDoc.getElementsByTagName(lbl)[0].getElementsByTagName("D5")[0].childNodes[0].nodeValue;
var tbl = tbl2.rows[i+1].cells;
tbl[1].innerHTML = v1;
tbl[2].innerHTML = v2;
tbl[3].innerHTML = v4;
tbl[4].innerHTML = v5;
tbl[5].innerHTML = v3;}
tbl2 = document.getElementById("ltcp");
if (tbl2 != null){
var Data = xmlDoc.getElementsByTagName("D2")[0];
tbl2.rows[1].cells[1].innerHTML = Data.getElementsByTagName("a")[0].childNodes[0].nodeValue;
tbl2.rows[2].cells[1].innerHTML = Data.getElementsByTagName("b")[0].childNodes[0].nodeValue;
tbl2.rows[3].cells[1].innerHTML = Data.getElementsByTagName("c")[0].childNodes[0].nodeValue;
tbl2.rows[4].cells[1].innerHTML = Data.getElementsByTagName("d")[0].childNodes[0].nodeValue;
tbl2.rows[5].cells[1].innerHTML = Data.getElementsByTagName("e")[0].childNodes[0].nodeValue;
tbl2.rows[6].cells[1].innerHTML = Data.getElementsByTagName("f")[0].childNodes[0].nodeValue;
tbl2.rows[7].cells[1].innerHTML = Data.getElementsByTagName("g")[0].childNodes[0].nodeValue;}
tbl2 = document.getElementById("lrtu");
if (tbl2 != null){
var Data = xmlDoc.getElementsByTagName("D3")[0];
tbl2.rows[1].cells[1].innerHTML = Data.getElementsByTagName("a")[0].childNodes[0].nodeValue;
tbl2.rows[2].cells[1].innerHTML = Data.getElementsByTagName("b")[0].childNodes[0].nodeValue;
tbl2.rows[3].cells[1].innerHTML = Data.getElementsByTagName("c")[0].childNodes[0].nodeValue;
tbl2.rows[4].cells[1].innerHTML = Data.getElementsByTagName("d")[0].childNodes[0].nodeValue;
tbl2.rows[5].cells[1].innerHTML = Data.getElementsByTagName("e")[0].childNodes[0].nodeValue;
tbl2.rows[6].cells[1].innerHTML = Data.getElementsByTagName("f")[0].childNodes[0].nodeValue;
tbl2.rows[7].cells[1].innerHTML = Data.getElementsByTagName("g")[0].childNodes[0].nodeValue;}
tbl2 = document.getElementById("tmisc");
if (tbl2 != null){
tbl2.rows[1].cells[1].innerHTML = NumUpdates;
tbl2.rows[2].cells[1].innerHTML = xmlDoc.getElementsByTagName("D4")[0].childNodes[0].nodeValue;
tbl2.rows[3].cells[1].innerHTML = xmlDoc.getElementsByTagName("D5")[0].childNodes[0].nodeValue;
tbl2.rows[4].cells[1].innerHTML = xmlDoc.getElementsByTagName("D6")[0].childNodes[0].nodeValue;
tbl2.rows[5].cells[1].innerHTML = xmlDoc.getElementsByTagName("D7")[0].childNodes[0].nodeValue;
tbl2.rows[6].cells[1].innerHTML = xmlDoc.getElementsByTagName("D8")[0].childNodes[0].nodeValue;
tbl2.rows[7].cells[1].innerHTML = xmlDoc.getElementsByTagName("D9")[0].childNodes[0].nodeValue;
tbl2.rows[8].cells[1].innerHTML = xmlDoc.getElementsByTagName("DA")[0].childNodes[0].nodeValue;
}
}
UpdateState = 0;}
else {}}
</script>
<TITLE>Show Status</TITLE></HEAD>
<BODY>

<h1 align=center>Gateway Device Status</h1><HR>
<BR><br />
<table  align="center" valign="top" width="90%"><tr><td rowspan="2" valign="top">
<table align="center" border='1'  id="TableStatus">
<tr><th COLSPAN="6">Automatic Reads</th></tr><tr align="center"><th>Table<br />Item<th>Error<br />Count<th>Last<br />Error<th>Retries<th>Timeouts<th>Number<br />Completed</tr>
<tr align="center"><td>01</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>02</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>03</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>04</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>05</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>06</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>07</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>08</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>09</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>10</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>11</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>12</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>13</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>14</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>15</td><td>0</td><td>&nbsp;</td><td>0</td><td>0</td><td>0</td></tr>
<tr align="center"><td>16</td><td>2816</td><td>&nbsp;</td><td>-16449536</td><td>69163</td><td>255</td></tr></table></td><td valign="top"><table width="100%"  border="1" id="ltcp"> <col width=120><col width=160><tr><th COLSPAN="2">Last Modbus TCP Request</th></tr><tr><td align="right">Slave Number</td><td>&nbsp;</td></tr><tr><td align="right">Function</td><td>&nbsp;</td></tr><tr><td align="right">Reference</td><td>&nbsp;</td></tr><tr><td align="right">Count</td><td>&nbsp;</td></tr><tr><td align="right">Data</td><td height="42" VALIGN="top">&nbsp;</td></tr><tr><td align="right">Status</td><td>&nbsp;</td></tr><tr><td align="right">Return</td><td>&nbsp;</td></tr></table></td><td valign="top"><table width="100%" border="1" id="lrtu"><col width=120><col width=160><tr><th COLSPAN="2">Last Modbus RTU Request</th></tr><tr><td align="right">Slave Number</td><td>&nbsp;</td></tr><tr><td align="right">Function</td><td>&nbsp;</td></tr><tr><td align="right">Reference</td><td>&nbsp;</td></tr><tr><td align="right">Count</td><td>&nbsp;</td></tr><tr><td align="right">Data</td><td height="42" VALIGN="top">&nbsp;</td></tr><tr><td align="right">Status</td><td>&nbsp;</td></tr><tr><td align="right">Return</td><td>&nbsp;</td></tr></table></td></tr><tr><td COLSPAN="2"><table width="100%"  border="1" id="tmisc"> <col width=90><col width=160><tr><th COLSPAN="2">Status Information</th></tr><tr><td align="right">Status Page Updates</td><td>&nbsp;</td></tr><tr><td align="right">Modbus TCP Requests</td><td>&nbsp;</td></tr><tr><td align="right">Modbus TCP Cache Hits</td><td>&nbsp;</td></tr><tr><td align="right">Modbus RTU Requests</td><td>&nbsp;</td></tr><tr><td align="right">Request Errors</td><td>&nbsp;</td></tr><tr><td align="right">Last Request Error</td><td>&nbsp;</td></tr><tr><td align="right">Request Retries</td><td>&nbsp;</td></tr><tr><td align="right">Request Timeouts</td><td>&nbsp;</td></tr></table></td></tr></table>
<script language=javascript>int2=self.setInterval("GetStatus()",50)
</script><br /><CENTER><button id="ssB" onclick="DoStartStopButtonClick()">Stop Updates</button>&nbsp&nbsp<button onclick="DoResetCounters()">Clear Values</button>&nbsp&nbsp<INPUT type="button" value="Back" onclick="history.go(-1)"></CENTER> </BODY></HTML>
